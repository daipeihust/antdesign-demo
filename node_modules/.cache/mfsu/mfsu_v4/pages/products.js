import ProductList from "@/components/ProductList";
import axios from "axios";
import React from "react";
import { useMutation, useQuery, useQueryClient } from "umi";
import styles from "./products.less";
export default function Page() {
  const queryClient = useQueryClient();
  const productsQuery = useQuery(["products"], {
    queryFn() {
      return axios.get("/api/products").then((res) => res.data);
    }
  });
  const productsDeleteMutation = useMutation({
    mutationFn(id) {
      return axios.delete(`/api/products/${id}`);
    },
    onSettled: () => {
      queryClient.invalidateQueries({ queryKey: ["products"] });
    }
  });
  if (productsQuery.isLoading)
    return null;
  return /* @__PURE__ */ React.createElement("div", null, /* @__PURE__ */ React.createElement("h1", { className: styles.title }, "Page products"), /* @__PURE__ */ React.createElement(
    ProductList,
    {
      products: productsQuery.data.data,
      onDelete: (id) => {
        productsDeleteMutation.mutate(id);
      }
    }
  ));
}
